extends ./component/layout.pug
include ./component/table-of-content.pug 

block css
    link(rel="stylesheet", href="/static/css/main.css")
    link(rel="stylesheet", href="/static/css/template.css")
    link(rel="stylesheet", href="//at.alicdn.com/t/font_1197539_vgn2vpugpwq.css")
block body
    .app
        .main
            .left
                .wrap
                    include ./component/header.pug
                    +tableOfContent(tree, true)
            .center
                .content
                    != doc
            .right
                .wrap
                    .toc
        .footer

block jsbottom
  script.
    const toc = document.querySelector("#目录").nextElementSibling
    if(toc.tagName === 'UL') {
      const t = toc.cloneNode(true)
      t.id = 'toc'
      document.querySelector('.toc').append(t)
    }
    const h2s  = document.querySelectorAll('h2')
    const tops = Array.from(h2s).map(item => item.offsetTop)
    

    const li = document.querySelectorAll('#toc li')
    li[0].setAttribute('class', 'active')


    window.addEventListener('scroll', function(e) {
      const scroll = document.documentElement.scrollTop

        

      for(let i = 0 ;i < tops.length ; i++) {
        if(scroll-30>= tops[i] ) {
          for(let j = 0; j < li.length; j++) {
            li[j].setAttribute('class', '')
          }
          li[i].setAttribute('class', 'active')
        }
      }
    })

    